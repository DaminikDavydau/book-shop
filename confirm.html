<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Book shop - Confirm Order</title>
	<style>
		input {
			border-radius: 5px;
		}
		input.correct {
	border: 2px solid green ;
}

.incorrect {
	border: 2px solid red ;
}
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
	<script>
		$(document).ready(function(){
			$(".correctspan").hide();
  			$("input").blur(function(){
    			$(".correctspan").hide();
    			$(".incorrectspan").show();
  			});  
		});
	</script>
</head>
<body>
	<h1>Confirmation form</h1>
	<a href="./index.html">Back to main page</a>
	<h4 style="margin-bottom: 7px;">To submit the form:</h4>
	<ol type="I" style="margin:0px auto;">
		<li>
			<p style="margin: auto;">Input your data:</p>
			<ul>
				<li>
					First Name: Only letters, min length 4; Last Name: Only letters, min length 5
				</li>
				<li>
					Delivery date: Enter a date starting from tomarrow
				</li>
				<li>
					Street: Letters and numbers, min length 5; House number: Only numbers, min length 1; Flat number: Numbers greater from 0, '23-2' format is also correct
				</li>
			</ul>
		</li>
		<li>
			Choose payment method
		</li>
		<li>
			And click Submit button
		</li>
	</ol>


	<form action="https://www.w3schools.com/action_page.php" onsubmit="alert(`The order created. The delivery address is ${document.getElementsByName('street')[0].value} street house ${document.getElementsByName('house')[0].value} flat ${document.getElementsByName('flat')[0].value}. Customer ${document.getElementsByName('fname')[0].value} ${document.getElementsByName('lname')[0].value}`);//return false" method="post">
		<script>
			function iscorrect() {
				let countcorrect = document.getElementsByClassName("correct")
				if (countcorrect.length >= 6) {
					let reg = document.getElementById("register")
					reg.removeAttribute("disabled");
				}
				else {
					let reg = document.getElementById("register")
					reg.setAttribute("disabled", "disabled");
				}
			};

			function fstname(value) {
				let tag = document.getElementsByName("fname")[0];
				let spn = document.getElementsByTagName("span")[0]
				if (value == value.match(/[A-Za-z]{4,}/)) {
					tag.setAttribute("class", 'correct')
					spn.setAttribute("class", 'correctspan') 
				}
				else {
					tag.setAttribute("class", 'incorrect') 
					spn.setAttribute("class", 'incorrectspan') 
				};
				iscorrect()
			};

			function lastname(value) {
				let tag = document.getElementsByName("lname")[0];
				let spn = document.getElementsByTagName("span")[1]
				if (value == value.match(/[A-Za-z]{5,}/)) {
					tag.setAttribute("class", 'correct')
					spn.setAttribute("class", 'correctspan') 
				}
				else {
					tag.setAttribute("class", 'incorrect') 
					spn.setAttribute("class", 'incorrectspan') 
				};
				iscorrect()
			};

			function delivDate(value, min) {
				let tag = document.getElementsByName("delDate")[0];
				let spn = document.getElementsByTagName("span")[2]
				if (value + min != min) {
					value = value.split('-')
					value = `${value[0]}${value[1]}${value[2]}`
					min = min.split('-')
					if (Number(min[2])<10) {
						min = `${min[0]}${min[1]}0${min[2]}`
					}
					else {
						min = `${min[0]}${min[1]}${min[2]}`
					}
					if (value >= min) {
						tag.setAttribute("class", 'correct')
					spn.setAttribute("class", 'correctspan') 
				}
				else {
					tag.setAttribute("class", 'incorrect') 
					spn.setAttribute("class", 'incorrectspan') 
					}
				}
				else {
						tag.setAttribute("class", 'incorrect')
						spn.setAttribute("class", 'incorrectspan') 

				};
				iscorrect()
			};

			function streetn(value) {
				let tag = document.getElementsByName("street")[0];
				let spn = document.getElementsByTagName("span")[3]
				if (value == value.match(/[0-9A-Za-z ]{5,}/)) {
					tag.setAttribute("class", 'correct')
					spn.setAttribute("class", 'correctspan') 
				}
				else {
					tag.setAttribute("class", 'incorrect') 
					spn.setAttribute("class", 'incorrectspan') 
				};
				iscorrect()
			};

			function housen(value) {
				let tag = document.getElementsByName("house")[0];
				let spn = document.getElementsByTagName("span")[4]
				if (value == value.match(/[0-9]{1,}/)) {
					tag.setAttribute("class", 'correct')
					spn.setAttribute("class", 'correctspan') 
				}
				else {
					tag.setAttribute("class", 'incorrect') 
					spn.setAttribute("class", 'incorrectspan') 
				}
				iscorrect()
			};

			function flatn(value) {
				let tag = document.getElementsByName("flat")[0];
				let spn = document.getElementsByTagName("span")[5]
				if (value == value.match(/[0-9]+[0-9-]*/)) {
					tag.setAttribute("class", 'correct')
					spn.setAttribute("class", 'correctspan') 
				}
				else {
					tag.setAttribute("class", 'incorrect') 
					spn.setAttribute("class", 'incorrectspan') 
				};
				iscorrect()
			};

		</script>
		<br><br>
		<label for="fname">First Name:</label>
        <input type="text" pattern="[A-Za-z]{4,}" name="fname" id="fname"  onblur="fstname(this.value)">
        <span class="correctspan">Only letters, min length 4</span>
        <br><br>
  
        <label for="lname">Last Name:</label>
        <input type="text" pattern="[A-Za-z]{5,}" name="lname" id="lname" onblur="lastname(this.value)">
        <span class="correctspan">Only letters, min length 5</span>
        <br><br>

        <label for="delDate">Delivery date:</label>
		<input type="date" id="delDate" name="delDate" onblur="delivDate(this.value, this.min)" >
       	<script>
       		let date = new Date().toISOString().split("T")[0].split("-");
       		date = `${date[0]}-${date[1]}-${Number(date[2])+1}`
       		delDate.min = date
   		</script> 
   		<span class="correctspan">Enter a date starting from tomarrow</span>
		<br><br>

		<label for="street">Street:</label>
        <input type="text" pattern="[0-9A-Za-z ]{5,}" name="street" id="street" onblur="streetn(this.value)" >
        <span class="correctspan">Letters and numbers, min length 5</span>
        <br><br>

		<label for="house">House number:</label>
        <input type="text" pattern="[0-9]{1,}" name="house" id="house" onblur="housen(this.value)" >
        <span class="correctspan">Only numbers, min length 1</span>
        <br><br>

		<label for="flat">Flat number:</label>
        <input type="text" pattern="[0-9]+[0-9-]*" name="flat" id="flat" onblur="flatn(this.value)" >
        <span class="correctspan">Numbers greater from 0, '23-2' format is also correct</span>
        <br><br>

		<input class="radio_period" id="month" type="radio" name="radio">
		<label class="radio_period" for="month">Cash</label>
		<input class="radio_period right" id="once" type="radio" name="radio" checked="checked">
		<label class="radio_period" for="once">Card</label>
		<br><br>

		<input type="submit" id="register" value="Submit" disabled="disabled">
		<script>
			function sbmt() {

				let doc = new DocumentFragment();
    let tag = document.createElement('h3');
    let str = document.getElementsByName("house")[0]
    tag.innerHTML = `The order created. The delivery address is ${str} street house 3 flat 10. Customer John Gald`
    doc.append(tag);
    document.querySelector('body input').append(doc);


			}
		</script>
	</form>
</body>
</html>
